<div class="button-wrapper">
  <button
    type="button"
    class="button-global"
    [ngClass]="{ active: tabName === 'add' }"
    (click)="changeTabName()">
    Add more
  </button>
  <button
    type="button"
    class="button-global"
    [ngClass]="{ active: tabName === 'peek' }"
    (click)="changeTabName()">
    All user in project
  </button>
</div>

<form
  class="form-global form"
  (ngSubmit)="onSubmit()"
  [formGroup]="form"
  *ngIf="tabName === 'add'; else peek">
  <p class="form-message">Find user by his email</p>
  <label class="form-label-global" for="email">Text</label>
  <input
    type="email"
    class="form-input-global"
    id="email"
    formControlName="email" />
  <p
    class="text-danger-global"
    *ngIf="(form.controls.email.touched || submitted) && form.controls.email.errors?.['required']">
    Name is required
  </p>
  <button class="button-global submit-button-global" type="submit">
    Search
  </button>
</form>
<div class="users-wrapper" *ngIf="tabName === 'add'">
  <p class="user-message" *ngIf="(searchedFilteredUsers$ | async) !== null">
    Only users which aren't added to this project are displayed
  </p>
  <p *ngIf="(searchedFilteredUsers$ | async) === null && submitted">
    loading...
  </p>
  <div class="user" *ngFor="let user of searchedFilteredUsers$ | async">
    <p>{{ user.email }}</p>
    <button
      type="button"
      class="button-global user-button"
      title="Add"
      (click)="onAddUser(user.userId)">
      <img src="../../../assets/plus-solid.svg" alt="add" />
    </button>
  </div>
</div>

<ng-template #peek>
  <p *ngIf="(projectUsers$ | async) === null">loading...</p>
  <div class="user" *ngFor="let user of projectUsers$ | async">
    <p>{{ user.email }}</p>
    <button
      type="button"
      *ngIf="user.userId !== (loggedInUser$ | async)"
      class="button-global user-button"
      title="Remove"
      (click)="onRemoveUser(user.userId)">
      <img src="../../../assets/minus-solid.svg" alt="minus" />
    </button>
  </div>
</ng-template>
